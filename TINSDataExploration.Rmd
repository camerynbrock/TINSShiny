---
title: "TINS ShinyApp Data Exploration"
author: "Cameryn Brock"
date: "2/4/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE,
                      warning = FALSE,
                      message = FALSE)
```

### Ideas for graphs

- Number of birds banded and recaps per year / total 
- Number of species / year
- Number of birds banded / species banded
- Number of birds banded with colors for species / families? - Need to put in families and orders but should be easy enough
- Capture rate? Number / net hour
- Check any change in weight / wing size over time within species

### Ideas for dashboards

- Could do big graph with number of birds banded per year, then you click and see # orders, families, species
- Could drop down menu of species (family, order) and see number banded per year / per some standardized effort and could allow to overlay on top of each other
- Visual spatial data with recaps

#### Questions for Will

- What is time? 

#### Other thoughts

- Consider doing only 2010-2015


```{r}

library(tidyverse)
library(here)
library(janitor)
library(lubridate)
library(kableExtra)

```

```{r, include = FALSE}
# Read in and clean up data to combine separate year files to one df

tins_2010 <- read_csv(here::here("RawData", "2010.csv"), 
                      col_types = cols(.default = "c")) %>%  
  select(-c(29, 30, 32)) %>% 
  head(212) 

tins_2011 <- read_csv(here::here("RawData", "2011.csv"), 
                      col_types = cols(.default = "c"))%>% 
  select(-c(29, 30, 32)) 

tins_2012 <- read_csv(here::here("RawData", "2012.csv"), 
                      col_types = cols(.default = "c"))

tins_2013 <- read_csv(here::here("RawData", "2013.csv"), 
                      col_types = cols(.default = "c"))
 
tins_2014 <- read_csv(here::here("RawData", "2014.csv"), 
                      col_types = cols(.default = "c"))
 
tins_2015 <- read_csv(here::here("RawData", "2015.csv"), 
                      col_types = cols(.default = "c")) %>% 
  select(-c(25:27)) %>% 
  rename("NOTE?" = "Comment")
 
tins_2016 <- read_csv(here::here("RawData", "2016.csv"), 
                      col_types = cols(.default = "c")) %>% 
  select(-c(25:27)) %>% 
  head(778) %>% 
  rename("NOTE?" = "Comment")

tins_2017 <- read_csv(here::here("RawData", "2017.csv"), 
                      col_types = cols(.default = "c")) %>% 
  head(167) %>% 
  rename("NOTE?" = "Comment")
 
tins_2018 <- read_csv(here::here("RawData", "2018.csv"), 
                      col_types = cols(.default = "c")) %>% 
  head(200) %>% 
  rename("NOTE?" = "Comment")
 
tins_2019 <- read_csv(here::here("RawData", "2019.csv"), 
                      col_types = cols(.default = "c")) %>% 
  head(29) %>% 
  rename("NOTE?" = "Comment")
```


```{r}

# bind all years

tins <- bind_rows(tins_2010,
                  tins_2011,
                  tins_2012,
                  tins_2013,
                  tins_2014,
                  tins_2015,
                  tins_2016,
                  tins_2017,
                  tins_2018,
                  tins_2019)

```

```{r}

# Tidy tins

tins_tidy <- tins %>% 
  clean_names() %>% 
  mutate(wing = as.numeric(wing),
         wght = as.numeric(wght)) %>% 
  mutate(date = lubridate::mdy(date),
         year = lubridate::year(date),
         month = lubridate::month(date),
         doy = lubridate::yday(date)) %>% 
  filter(!year == "2003")

```

```{r}

# Banding effort over time

ggplot(tins_tidy, aes(x = year)) + 
  geom_histogram(color = "grey90",
                 fill = "lightblue3",
                 bins = 10) + 
  scale_x_continuous(breaks = seq(2010, 2019, by = 1)) + 
  labs(x = "Year",
       y = "Birds Banded") +
  theme_minimal() 

```

```{r}

# Summarize data

spec_summary <- tins_tidy %>% 
  group_by(year, spec) %>% 
  summarize(count = n())

ggplot(spec_summary, aes(x = year)) + 
  geom_histogram(color = "grey90",
                 fill = "lightblue3",
                 bins = 10) + 
  scale_x_continuous(breaks = seq(2010, 2019, by = 1)) + 
  labs(x = "Year",
       y = "Species Banded") +
  theme_minimal() 

```


